### DO NOT EDIT THIS FILE
### This file is auto-generated by the Dyad command-line compiler.
### If you edit this code it is likely to get overwritten.
### Instead, update the Dyad source code and regenerate this file


@doc Markdown.doc"""
   CoffeeMugSubsystem(; name, C_espresso, T0_espresso, C_cup, T0_cup, Gc_internal, G_wall, Gc_external, Gr_external)

==============================================================================
COFFEE MUG SUBSYSTEMS
==============================================================================
Three subsystem components for espresso cooling model:
1. CoffeeMugSubsystem - Coffee and mug thermal masses with heat transfer
2. SteamSubsystem - Top surface heat transfer (convection + radiation)
3. HandSubsystem - Hand thermal mass with contact conductance
==============================================================================
==============================================================================
SUBSYSTEM 1: Coffee and Mug
==============================================================================

## Parameters: 

| Name         | Description                         | Units  |   Default value |
| ------------ | ----------------------------------- | ------ | --------------- |
| `C_espresso`         | ---------------------------------------------------------------------------
Parameters
---------------------------------------------------------------------------
Espresso thermal properties                         | J/K  |   248.5 |
| `T0_espresso`         | J/K (60 mL water)                         | K  |   363.15 |
| `C_cup`         | K (90°C initial)
Cup thermal properties                         | J/K  |   113 |
| `T0_cup`         | J/K (porcelain)                         | K  |   293.15 |
| `Gc_internal`         | K (20°C initial)
Internal convection (espresso → cup inner wall)                         | --  |   0.6314 |
| `G_wall`         | W/K
Conduction through cup wall                         | W/K  |   2.74 |
| `Gc_external`         | W/K
External convection (cup → environment)                         | --  |   0.0705 |
| `Gr_external`         | W/K
External radiation (cup → environment)                         | --  |   0.005 |

## Connectors

 * `topSurface` - This connector represents a thermal node with temperature and heat flow as the potential and flow variables, respectively. ([`Node`](@ref))
 * `outerSurface` - This connector represents a thermal node with temperature and heat flow as the potential and flow variables, respectively. ([`Node`](@ref))
 * `ambient` - This connector represents a thermal node with temperature and heat flow as the potential and flow variables, respectively. ([`Node`](@ref))
 * `espressoTemp_degC` - This connector represents a real signal as an output from a component ([`RealOutput`](@ref))
"""
@component function CoffeeMugSubsystem(; name, C_espresso=248.5, T0_espresso=363.15, C_cup=113, T0_cup=293.15, Gc_internal=0.6314, G_wall=2.74, Gc_external=0.0705, Gr_external=0.005)
  __params = Any[]
  __vars = Any[]
  __systems = System[]
  __guesses = Dict()
  __defaults = Dict()
  __initialization_eqs = []
  __eqs = Equation[]

  ### Symbolic Parameters
  append!(__params, @parameters (C_espresso::Real = C_espresso), [description = "---------------------------------------------------------------------------
Parameters
---------------------------------------------------------------------------
Espresso thermal properties"])
  append!(__params, @parameters (T0_espresso::Real = T0_espresso), [description = "J/K (60 mL water)"])
  append!(__params, @parameters (C_cup::Real = C_cup), [description = "K (90°C initial)
Cup thermal properties"])
  append!(__params, @parameters (T0_cup::Real = T0_cup), [description = "J/K (porcelain)"])
  append!(__params, @parameters (Gc_internal::Real = Gc_internal), [description = "K (20°C initial)
Internal convection (espresso → cup inner wall)"])
  append!(__params, @parameters (G_wall::Real = G_wall), [description = "W/K
Conduction through cup wall"])
  append!(__params, @parameters (Gc_external::Real = Gc_external), [description = "W/K
External convection (cup → environment)"])
  append!(__params, @parameters (Gr_external::Real = Gr_external), [description = "W/K
External radiation (cup → environment)"])

  ### Variables
  append!(__vars, @variables (espressoTemp_degC(t)::Real), [output = true])

  ### Constants
  __constants = Any[]

  ### Components
  push!(__systems, @named topSurface = __Dyad__Node())
  push!(__systems, @named outerSurface = __Dyad__Node())
  push!(__systems, @named ambient = __Dyad__Node())
  push!(__systems, @named hotEspresso = ThermalComponents.HeatCapacitor(C=C_espresso, T0=T0_espresso))
  push!(__systems, @named cupMass = ThermalComponents.HeatCapacitor(C=C_cup, T0=T0_cup))
  push!(__systems, @named convEspresso2Cup = ThermalComponents.Convection())
  push!(__systems, @named gcEsp2Cup = BlockComponents.Constant(k=Gc_internal))
  push!(__systems, @named condCup = ThermalComponents.ThermalConductor(G=G_wall))
  push!(__systems, @named convCup2Env = ThermalComponents.Convection())
  push!(__systems, @named gcCup2Env = BlockComponents.Constant(k=Gc_external))
  push!(__systems, @named radCup2Env = ThermalComponents.BodyRadiation(Gr=Gr_external))
  push!(__systems, @named tempSensor = ThermalComponents.TemperatureSensor())
  push!(__systems, @named to_degC = BlockComponents.Gain(k=1))
  push!(__systems, @named offset_degC = BlockComponents.Constant(k=-273.15))
  push!(__systems, @named add_offset = BlockComponents.Add())

  ### Guesses

  ### Defaults

  ### Initialization Equations

  ### Assertions
  __assertions = []

  ### Equations
  # ---------------------------------------------------------------------------
  # Internal thermal path: espresso → cup inner wall → cup outer surface
  # ---------------------------------------------------------------------------
  # Espresso to cup internal convection
  push!(__eqs, connect(hotEspresso.node, convEspresso2Cup.solid))
  push!(__eqs, connect(convEspresso2Cup.fluid, cupMass.node))
  push!(__eqs, connect(gcEsp2Cup.y, convEspresso2Cup.Gc))
  # Conduction through cup wall (cup inner to outer)
  push!(__eqs, connect(cupMass.node, condCup.node_a))
  # ---------------------------------------------------------------------------
  # External interfaces
  # ---------------------------------------------------------------------------
  # Top surface exposed to steam subsystem
  push!(__eqs, connect(hotEspresso.node, topSurface))
  # Outer surface exposed to hand and environment
  push!(__eqs, connect(condCup.node_b, outerSurface))
  # External convection path: cup outer surface → ambient
  push!(__eqs, connect(outerSurface, convCup2Env.solid))
  push!(__eqs, connect(convCup2Env.fluid, ambient))
  push!(__eqs, connect(gcCup2Env.y, convCup2Env.Gc))
  # External radiation path: cup outer surface → ambient
  push!(__eqs, connect(outerSurface, radCup2Env.node_a))
  push!(__eqs, connect(radCup2Env.node_b, ambient))
  # ---------------------------------------------------------------------------
  # Temperature measurement and conversion
  # ---------------------------------------------------------------------------
  push!(__eqs, connect(tempSensor.node, hotEspresso.node))
  push!(__eqs, connect(tempSensor.T, to_degC.u))
  push!(__eqs, connect(to_degC.y, add_offset.u1))
  push!(__eqs, connect(offset_degC.y, add_offset.u2))
  push!(__eqs, connect(add_offset.y, espressoTemp_degC))

  # Return completely constructed System
  return System(__eqs, t, __vars, __params; systems=__systems, defaults=__defaults, guesses=__guesses, name, initialization_eqs=__initialization_eqs, assertions=__assertions)
end
export CoffeeMugSubsystem
