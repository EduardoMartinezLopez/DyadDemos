### DO NOT EDIT THIS FILE
### This file is auto-generated by the Dyad command-line compiler.
### If you edit this code it is likely to get overwritten.
### Instead, update the Dyad source code and regenerate this file


@doc Markdown.doc"""
   SimpleVehicle(; name, vehicle_mass_kg, inertia_moment, wheel_radius, damping_coeff, initial_angle, initial_speed)

Simple vehicle model with rotational shaft interface

This component represents a basic vehicle drivetrain model with:
- A rotational shaft interface for connecting to drive systems
- An inertia representing the rotating mass (engine/motor inertia)
- A rolling wheel that converts rotational to translational motion
- A vehicle mass representing the vehicle body
- A translational damper representing vehicle load/resistance
- Fixed supports for the wheel and damper

## Parameters: 

| Name         | Description                         | Units  |   Default value |
| ------------ | ----------------------------------- | ------ | --------------- |
| `vehicle_mass_kg`         | Physical parameters - with defaults for typical passenger car
Vehicle mass in kg                         | kg  |   2194 |
| `inertia_moment`         | Rotational inertia in kg⋅m²                         | kg.m2  |   3.08 |
| `wheel_radius`         | Wheel radius in m                         | m  |   0.15 |
| `damping_coeff`         | Combined drag/resistance in N⋅s/m                         | N.s/m  |   30 |
| `initial_angle`         | Initial conditions for the inertia                         | rad  |   0 |
| `initial_speed`         |                          | rad/s  |   0 |

## Connectors

 * `shaft` - This connector represents a rotational spline with angle and torque as the potential and flow variables, respectively. ([`Spline`](@ref))
 * `vehicle_speed` - This connector represents a real signal as an output from a component ([`RealOutput`](@ref))
 * `wheel_speed` - This connector represents a real signal as an output from a component ([`RealOutput`](@ref))
"""
@component function SimpleVehicle(; name, vehicle_mass_kg=2194, inertia_moment=3.08, wheel_radius=0.15, damping_coeff=30, initial_angle=0, initial_speed=0)
  __params = Any[]
  __vars = Any[]
  __systems = System[]
  __guesses = Dict()
  __defaults = Dict()
  __initialization_eqs = []
  __eqs = Equation[]

  ### Symbolic Parameters
  append!(__params, @parameters (vehicle_mass_kg::Real = vehicle_mass_kg), [description = "Physical parameters - with defaults for typical passenger car
Vehicle mass in kg"])
  append!(__params, @parameters (inertia_moment::Real = inertia_moment), [description = "Rotational inertia in kg⋅m²"])
  append!(__params, @parameters (wheel_radius::Real = wheel_radius), [description = "Wheel radius in m"])
  append!(__params, @parameters (damping_coeff::Real = damping_coeff), [description = "Combined drag/resistance in N⋅s/m"])
  append!(__params, @parameters (initial_angle::Real = initial_angle), [description = "Initial conditions for the inertia"])
  append!(__params, @parameters (initial_speed::Real = initial_speed))

  ### Variables
  append!(__vars, @variables (vehicle_speed(t)::Real), [output = true])
  append!(__vars, @variables (wheel_speed(t)::Real), [output = true])

  ### Constants
  __constants = Any[]

  ### Components
  push!(__systems, @named shaft = __Dyad__Spline())
  push!(__systems, @named inertia = RotationalComponents.Inertia(J=inertia_moment))
  push!(__systems, @named wheel = RotationalComponents.IdealRollingWheel(radius=wheel_radius))
  push!(__systems, @named vehicle_mass = TranslationalComponents.Mass(m=vehicle_mass_kg))
  push!(__systems, @named load_damper = TranslationalComponents.Damper(d=damping_coeff))
  push!(__systems, @named ground = TranslationalComponents.Fixed(s0=0))
  push!(__systems, @named housing = RotationalComponents.Fixed(phi0=0))
  push!(__systems, @named load_anchor = TranslationalComponents.Fixed(s0=0))

  ### Guesses

  ### Defaults
  __defaults[inertia.phi] = (initial_angle)
  __defaults[inertia.w] = (initial_speed)

  ### Initialization Equations

  ### Assertions
  __assertions = []

  ### Equations
  # Output signal assignments
  # Vehicle translational speed
  push!(__eqs, vehicle_speed ~ vehicle_mass.v)
  # Wheel rotational speed
  push!(__eqs, wheel_speed ~ inertia.w)
  # Connect shaft to inertia
  push!(__eqs, connect(shaft, inertia.spline_a))
  # Connect inertia to rolling wheel
  push!(__eqs, connect(inertia.spline_b, wheel.spline))
  # Connect wheel translational side to vehicle mass
  push!(__eqs, connect(wheel.flange, vehicle_mass.flange_a))
  # Connect vehicle mass to load damper
  push!(__eqs, connect(vehicle_mass.flange_b, load_damper.flange_a))
  # Connect damper to load anchor
  push!(__eqs, connect(load_damper.flange_b, load_anchor.flange))
  # Connect wheel translational support to ground
  push!(__eqs, connect(wheel.support_t, ground.flange))
  # Connect wheel rotational support to housing
  push!(__eqs, connect(wheel.support_r, housing.spline))

  # Return completely constructed System
  return System(__eqs, t, __vars, __params; systems=__systems, defaults=__defaults, guesses=__guesses, name, initialization_eqs=__initialization_eqs, assertions=__assertions)
end
export SimpleVehicle
